A useful pre-processing trick I discovered any time you want to spend time on image processing, start with :
The Gimp (probably same elsewhere), Colours -> Levels...
then on Input Levels, drag the black pointer from the bottom-left to a tiny bit below where the curve starts, same with the white pointer on right for end of curve. Then shift the middle pointer until it looks right. It's only really doing brightness & contrast, but this way you're sure to keep all the useful data, make best use of the dynamic range.   



